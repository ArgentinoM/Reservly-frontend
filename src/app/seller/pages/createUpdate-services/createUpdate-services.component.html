@if (isLoading()) {
  <spiner />
}@else {
  <section
    class="relative shadow-2xl bg-cover w-full min-h-screen flex flex-col items-center justify-start overflow-hidden py-8 md:py-16">

    <div
      class="relative z-10 max-w-4xl w-[90%] bg-secondary shadow-2xl shadow-primary/10 text-text-primary rounded-3xl p-5 md:p-10">

      <!-- Back -->
      <button (click)="back()"
        class="flex items-center cursor-pointer gap-2 mb-8 text-accent hover:text-primary transition">
        <i class="fa-solid fa-arrow-left"></i>
        <span class="font-semibold">Regresar</span>
      </button>

      <h1 class="text-3xl font-bold text-primary mb-6">
        {{ isEditMode() ? 'Actualizar Servicio' : 'Crear Nuevo Servicio' }}
      </h1>

      <div class="grid grid-cols-1 gap-8">

        <div class="bg-tercery/10 p-6 rounded-3xl shadow-inner border border-tercery">
          <form class="flex flex-col gap-6"
            [formGroup]="FormActions"
            (ngSubmit)="onSubmit()">

            <!-- Name -->
            <div class="flex flex-col gap-2">
              <label class="font-semibold">Nombre del servicio</label>
              <input type="text"
                formControlName="name"
                class="p-3 rounded-xl bg-tercery/30 border border-tercery shadow-inner text-text-primary"
                placeholder="Ej: Corte de cabello profesional">
            </div>

            <!-- Desc -->
            <div class="flex flex-col gap-2">
              <label class="font-semibold">Descripción</label>
              <textarea rows="4"
                formControlName="desc"
                class="p-3 rounded-xl bg-tercery/30 border border-tercery shadow-inner text-text-primary"
                placeholder="Descripción del servicio"></textarea>
            </div>

            <!-- Price + Duration -->
            <div class="grid grid-cols-2 gap-6">

              <!-- Price -->
              <div class="flex flex-col gap-2">
                <label class="font-semibold">Precio (MXN)</label>
                <input type="number"
                  formControlName="price"
                  class="p-3 rounded-xl bg-tercery/30 border border-tercery shadow-inner text-text-primary"
                  placeholder="200">
              </div>

              <!-- Duration -->
              <div class="flex flex-col gap-2">
                <label class="font-semibold">Duración (horas)</label>
                <input type="number"
                  formControlName="duration"
                  value="1"
                  class="p-3 rounded-xl bg-tercery/30 border border-tercery shadow-inner text-text-primary"
                  placeholder="2">
              </div>
            </div>

            <!-- Categories -->
            <div class="flex flex-col gap-2">
              <label class="font-semibold">Categoría</label>
              <select formControlName="category_id"
                class="p-3  rounded-xl bg-tercery border border-tercery shadow-inner text-text-primary">
                <option value=""
                  disabled>Selecciona una categoria</option>
                @for (category of categoriesResoruces.value()?.data; track $index) {
                <option [value]="category.id"
                  selected>{{category.name}}</option>
                }
              </select>
            </div>

            <!-- Img -->
            <div class="flex flex-col gap-3">
              <label class="font-semibold">Imagen del servicio</label>


              <div class="flex items-center gap-4">


                <input id="imagen"
                  type="file"
                  accept="image/jpeg, image/png, image/webp"
                  class="hidden"
                  (change)="onFileSelected($event)" />


                <label for="imagen"
                  class="flex items-center gap-3 px-4 py-2 bg-primary/10 border border-tercery rounded-xl cursor-pointer hover:bg-primary/5 transition">
                  <i class="fa-solid fa-upload"></i>
                  <span class="text-sm">Subir imagen</span>
                </label>

                <span class="text-sm opacity-70">
                  Formato: jpeg, png, webp — Máx 5MB
                </span>
              </div>

            </div>


            <div class="pt-2">
              <button class="w-full flex items-center justify-center gap-3 px-6 py-3 cursor-pointer rounded-xl font-semibold
                 bg-primary text-white shadow-lg hover:bg-primary/90 active:scale-95 transition">
                   <i
                    class="fa-solid"
                    [class.fa-plus]="!isEditMode()"
                    [class.fa-save]="isEditMode()">
                  </i>
                {{ isEditMode() ? 'Actualizar Servicio' : 'Crear Servicio'  }}
              </button>
            </div>

          </form>
        </div>


        <!-- Preview -->
        <aside class="bg-secondary/40 p-6 flex flex-col items-center  rounded-2xl border border-tercery shadow-md">
          <div
            class="bg-secondary rounded-xl overflow-hidden shadow-md border border-tercery duration-500 hover:shadow-primary/50 hover:shadow-2xl transition flex flex-col ">

            <div class="relative">

              <img
                [src]="imgPreview() ?? 'https://res.cloudinary.com/dmow8n7pu/image/upload/v1761335291/fotografo_interiores_cdjhav.jpg'"
                alt="Video"
                class="h-44 w-full object-cover"
                loading="lazy" />
            </div>

            <div class="p-5 flex flex-col flex-1">

              <div class="flex flex-col gap-2">
                <h3 class="font-semibold text-text-primary text-lg truncate">{{FormActions.value.name || 'Nuevo servicio'}}
                </h3>

                <p class="text-sm text-gray-400 line-clamp-2 leading-snug">
                  {{ FormActions.value.desc || 'Descripcion'}}
                </p>
              </div>


              <div class="flex flex-col mt-5 gap-2.5">
                <div class="flex items-center gap-[2px] text-yellow-400">
                  <span class="mr-1 text-xs text-gray-300">4.5</span>
                  <i class="fa-solid fa-star"></i>
                  <i class="fa-solid fa-star"></i>
                  <i class="fa-solid fa-star"></i>
                  <i class="fa-solid fa-star"></i>
                  <i class="fa-solid fa-star-half"></i>
                  <span class="ml-1 text-xs text-gray-400">1,000</span>
                </div>


                <span class="text-success font-semibold">
                  {{ FormActions.value.price || '5000' | currency:'MXN' }}
                </span>

                <a
                  class="bg-primary mt-1 cursor-pointer text-center text-text-primary py-1 rounded-md hover:bg-accent hover:text-gray-800 transition">
                  Más info
                </a>
              </div>
            </div>
          </div>
        </aside>

      </div>

    </div>
  </section>
}

@if (alertVisible()) {
<notifications-component [type]="alertType()"
  (close)="alertVisible.set(false)"
  [message]="alertMessage()" />
}


